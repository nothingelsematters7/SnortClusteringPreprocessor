\section{ОБЗОР МЕТОДОВ И СИСТЕМ \\ОБНАРУЖЕНИЯ КОМПЬЮТЕРНЫХ АТАК}

В данном разделе приведен обзор основных методов обнаружения компьютерных атак, используемых в современных СОА, а также нескольких некоммерческих СОА.
Целью обзора является исследовать эффективность доступных в настоящее время СОА и определить основные недостатки используемых в них методов обнаружения атак. Основная сложность составления подобного обзора заключается в том, что множество доступных реализаций СОА представлено, в основном, коммерческими системами (такими как Cisco IPS, Juniper NetScreen, ISS RealSecure, NFR и т.д.), для которых отсутствует открытая информация о программной архитектуре и используемым формальным методам обнаружения атак. Доступная информация по подобным системам носит маркетинговый характер, что затрудняет проведение сравнительного анализа по публикациям в литературе. По этой причине множество рассматриваемых в обзоре систем будет ограничено СОА с открытым исходным кодом, доступным публично.
В результате обзора будет показано, что:

\begin{enumerate}

\item Большинство современных СОА используют на базовом уровне ту или иную реализацию сигнатурного метода обнаружения (pattern matching, сравнение шаблонов). Реализации отличаются друг от друга уровнем рассмотрения системы, алфавитом сигнатур и используемым <<движком>> --- от простого поиска подстрок до полноценной реализации регулярных выражений над заданным алфавитом.
\item Множество существующих методов обнаружения атак много шире, но их использование в системах имеет принципиальные ограничения, связанные с требованиями верифицируемости, устойчивости и воспроизводимости результата, а также большим числом ошибок второго рода (ложных срабатываний). Использование таких методов ограничено экспериментальными академическими разработками.
\item Доступные реализации СОА неустойчивы к модификациям атак и не могут автоматически адаптироваться к появлению новых атак. При этом использование методов обнаружения аномалий (например, в препроцессорах СОА Snort) ограничено по причинам, перечисленным в п.2.

\end{enumerate}


% \textbf{Штрихкод} (сокр. от << код}>>, англ. 
% <<\textit{bar code}>>) --- графическая информация наносимая на 
% поверхности предметов, предназначенная для обработки техническими
% средствами.

% Выделяют две большие группы штрихкодов: \textit{линейные} 
% и \textit{двухмерные}.
% В первом случае информационную нагрузку имеют только чередования 
% участков различной яркости по одной из осей, во втором --- по обеим.


\subsection{\textsc{Критерии сравнения}}  

В обзоре используются две группы критериев: первая группа характеризует собственно методы обнаружения атак и специфичные для них качественные и количественные показатели эффективности, в то время как вторая группа критериев характеризует реализации этих методов в системах обнаружения атак.

\subsubsection{Критерии сравнения методов обнаружения атак}

Для сравнительного анализа методов обнаружения атак выбраны следующие критерии:

\textbf{Уровень наблюдения за системой:} Данный критерий определяет уровень абстракции анализируемых событий в защищаемой системе и определяет границы применимости метода для обнаружения атак в сетях. В рамках данного обзора рассматриваются следующие уровни:

\begin{itemize}

\item HIDS --- наблюдение на уровне операционной системы отдельного узла сети
\item NIDS --- наблюдение на уровне сетевого взаимодействия объектов на узлах сети
\item AIDS --- наблюдение на уровне отдельных приложений узла сети
\item Hybrid --- комбинация наблюдателей разных уровней

\end{itemize}

\textbf{Верифицируемость метода:} Данный критерий позволяет оценить, может ли человек (например, квалифицированный оператор СОА или эксперт) воспроизвести последовательность шагов по принятию решения о наличии атаки, сопоставляя входные и выходные данные СОА. Например, сигнатурные методы будем считать верифицируемыми, а кластерные – нет. Верифицируемость позволяет провести экспертную оценку корректности метода и его реализации в произвольный момент времени, в том числе в процессе эксплуатации системы обнаружения на его основе. Свойство верифицируемости метода важно при эксплуатации системы обнаружения атак в реальной обстановке в качестве средства сбора доказательной базы об атаках.

Возможные значения: высокая (+), низкая (-).

\textbf{Адаптивность метода:} Оценка устойчивости метода к малым изменениям реализации атаки, которые не изменяют результат атаки. Адаптивность является единственным существенным преимуществом <<альтернативных>> методов обнаружения атак перед <<сигнатурными>>. Отсутствие адаптивности не позволяет системе защиты оперативно реагировать на неизвестные атаки и требует организации системы регулярного обновления баз известных атак, по аналогии с антивирусными системами. Возможные значения: высокая (+), низкая (-).

\textbf{Устойчивость:} Данный критерий характеризует независимость выхода метода от защищаемой системы --- для одного и того же входа метод должен давать один и тот же выход, независимо от защищаемой системы. Проблема устойчивости особенно остро стоит для статистических методов, анализирующих абсолютные значения параметров производительности и загруженности ресурсов сети и узлов, которые могут существенно отличаться на различных узлах и в различных сетях. Обученный в одной сети распознаватель может быть устойчивым в пределах данной сети и неустойчивым во всех остальных сетях. Такую устойчивость будем называть локальной. Так как процедура обучения обычно является <<дорогой>> --- требует использования большого количества ресурсов и времени --- число процедур обучения желательно минимизировать. Методы обнаружения атак, анализирующие семантику ввода, более устойчивы, чем статистические. Возможные значения: глобальная (+), локальная (-).


\textbf{Вычислительная сложность:} Теоретическая оценка сложности метода на основе информации из публикаций. В обзоре рассматривается только сложность метода в режиме обнаружения, без учёта возможных предварительных этапов настройки и обучения. Данный критерий является ключевым для задачи обнаружения атак в сетях и имеет гораздо большее значение, нежели сложность по памяти из-за опережающего роста пропускной способности каналов передачи данных и удешевления машинной памяти.

\begin{itemize}

\item Сублинейная --- константа, логарифм

\item Линейная

\item Квадратичная и т.д.

\end{itemize}

В обзоре не рассмотрены такие важные критерии как полнота и точность метода, т.к. эти характеристики редко приводятся в публикациях.

\subsubsection{Критерии сравнения систем обнаружения атак}

Для сравнительного анализа СОА были выбраны следующие критерии:\\
\textbf{Класс обнаруживаемых атак.} Данный критерий определяет, какие классы атак способна обнаружить рассматриваемая система. Это один из ключевых критериев. В связи с тем, что на сегодняшний день ни одна система не способна обнаружить атаки всех классов, для более полного покрытия всего спектра атак необходимо комбинировать различные СОА. Здесь мы используем классификацию атак, основанную на разделении ресурсов защищаемой системы по типам.

Класс атаки – это четверка <\textbf{L,R,A,D}>, где L --- расположение атакующего объекта, R~--- атакуемый ресурс, A~--- целевое воздействие на ресурс, D~--- признак распределенного характера атаки.

\textbf{L:} расположение атакующего объекта. Оно может быть либо внутренним по отношению к защищаемой системе \textbf{(li)}, либо внешним \textbf{(le)}.

\textbf{R:} атакуемый ресурс. Ресурсы разделяются по расположению и по типу.

\begin{itemize}

\item По расположению: узловые \textbf{(rl)}, сетевые \textbf{(rn)}.

\item По типу: пользовательские ресурсы \textbf{(ru)}, системные ресурсы \textbf{(rs)}, ресурсы СУБД \textbf{(rd)}, вычислительные ресурсы \textbf{(rc)}, ресурсы защиты \textbf{(rp)}.

\end{itemize}

\textbf{A:} целевое воздействие на ресурс: сбор информации \textbf{(as)}, получение прав пользователя ресурса \textbf{(au)}, получение прав администратора ресурса \textbf{(ar)}, нарушение целостности ресурса \textbf{(ai)}, нарушение работоспособности ресурса \textbf{(ad)}.

\textbf{D:} признак распределенного характера атаки: распределенные \textbf{(dd)}, нераспределенные \textbf{(dn)}.

Следующий критерий характеризует источники и способы сбора информации о поведении объектов и состоянии ресурсов:\\

\textbf{Уровень наблюдения за системой.} Определяет, на каком уровне защищаемой системы собирают данные для обнаружения атаки. Различаются узловые и сетевые источники. В пределах узловых источников разделяются уровни ядра и приложения. От уровня наблюдения за системой зависит скорость сбора информации, влияние системы на собираемую информацию, вероятность получения искаженной информации. Следует отметить, что использование метода обнаружения, позволяющего анализировать поведение на всех уровнях абстракции, не означает, что эта возможность реализована в конкретной системе. Зачастую реализация обладает меньшими возможностями, чем теоретические возможности используемого ею метода. 

\begin{itemize}

\item HIDS~--- наблюдение на уровне операционной системы отдельного узла сети
\item NIDS~--- наблюдение на уровне сетевого взаимодействия объектов на узлах сети
\item AIDS~--- наблюдение на уровне отдельных приложений узла сети
\item Hybrid~--- комбинация наблюдателей разных уровней

\end{itemize}

Следующий критерий определяет эффективность обнаружения атаки на основе анализа полученной информации.

\textbf{Используемый метод обнаружения.} Метод обнаружения также является ключевым критерием сравнения. Существует два класса методов: \textit{методы обнаружения аномалий} и \textit{методы обнаружения злоупотреблений}. В приведенном ниже списке перечислены не отдельные методы, но, в основном, семейства методов, объединённых некоторым единым подходом или теоретической моделью. 
\begin{itemize}

\item Обнаружение злоупотреблений

\begin{itemize}

\item Анализ систем состояний
\item Графы атак
\item Нейронные сети
\item Иммунные сети
\item SVM
\item Экспертные системы
\item Методы, основанные на спецификациях
\item MARS – Multivariate Аdaptive Regression Splines
\item Сигнатурные методы

\end{itemize}

\item Обнаружение аномалий

\begin{itemize}

\item Статистический анализ
\item Кластерный анализ (data mining)
\item Нейронные сети
\item Иммунные сети
\item Экспертные системы
\item Поведенческая биометрия
\item SVM
\item Анализ систем состояний

\end{itemize}

\end{itemize} 

\textbf{Адаптивность к неизвестным атакам.} Определяет способность используемого
метода обнаруживать ранее неизвестные атаки.\\
Следующие критерии определяют такие архитектурные особенности СОА как управление и распределенность.

\textbf{Масштабируемость.} Определяет возможность добавления новых анализируемых ресурсов сети, новых узлов и каналов передачи данных, в том числе возможность управления единой распределенной системой обнаружения атак. Управление может быть централизованное и/или распределенное. Дополнительно может присутствовать возможность удаленного управления СОА. Сюда включаются задачи установки, настройки и администрирования системы. При полностью распределенном управлении необходимо управлять всеми компонентами СОА в отдельности. При полностью централизованном управлении все компоненты СОА могут управляться с одного узла. Оптимальной представляется организация управления по централизованной схеме, в которой может быть несколько центров, и они могут динамически меняться.

\textbf{Открытость.} Определяет насколько система является открытой для интеграции в нее других методов обнаружения атак, компонентов сторонних разработчиков и сопряжения ее с другими системами защиты информации. Это могут быть программные интерфейсы для встраивания дополнительных модулей и/или реализация стандартов взаимодействия сетевых компонентов.

\textbf{Формирование ответной реакции на атаку.} Определяет наличие в системе встроенных механизмов ответной реакции на атаку, кроме самого факта ее регистрации. Примерами реакции могут быть разрыв соединения с атакующим объектом, блокировка его на межсетевом экране, отслеживание пути проникновения атакующего объекта в защищаемую систему и т.д.

\textbf{Защищенность.} Определяет степень защищенности СОА от атак на ее компоненты, включая защиту передаваемой информации, устойчивость к частичному выходу компонентов из строя или их компрометации. Затрагиваются такие вопросы, как наличие уязвимостей в компонентах СОА, защищенность каналов передачи данных между ними, а также авторизация компонентов внутри СОА.

Таким образом, некая <<идеальная>> система обнаружения атак обладает следующими свойствами:
\begin{itemize}

\item покрывает все классы атак (система полна)
\item позволяет анализировать поведение защищаемой РИС на всех уровнях: сетевом, узловом и уровне отдельных приложений
\item адаптивна к неизвестным атакам (использует адаптивный метод обнаружения атак)
\item масштабируется для РИС различных классов: от небольших локальных сетей класса <<домашний офис>> до крупных многосегментных и коммутированных корпоративных сетей, обеспечивая возможность централизованного управления всеми компонентами СОА
\item является открытой
\item имеет встроенные механизмы реагирования на атаки
\item является защищённой от атак на компоненты СОА, в том числе от перехвата управления или атаки <<отказ в обслуживании>>.

\end{itemize}

\subsection{\textsc{Методы обнаружения атак}}

Все методы обнаружения атак можно разделить на два класса: методы обнаружения аномалий и методы обнаружения злоупотреблений. Методы первого класса базируются на наличии готового описания нормального поведения наблюдаемых объектов РИС, и любое отклонение от нормального поведения считается аномальным (нарушением). Методы обнаружения злоупотреблений основаны на описании известных нарушений или атак: если наблюдаемое поведение некоторого объекта РИС совпадает с описанием известной атаки, поведение объекта считается атакой.

\subsubsection{Методы обнаружения злоупотреблений}

\textbf{Анализ систем состояний:} В данной группе методов функционирование защищаемой системы представляется через множество состояний и множество переходов между ними, т.е. в виде ориентированного графа (как правило, бесконечного). Суть метода обнаружения атак заключается в том, что часть путей в таком графе помечаются как недопустимые; конечное состояние каждого такого пути считается опасным для защищаемой системы. Процесс обнаружения атаки представляет собой построение части графа состояний системы и наблюдаемых переходов между ними, и поиск в полученном графе известных недопустимых путей. Обнаружение последовательности переходов, приводящей в опасное состояние, означает успешное обнаружение атаки. В соответствии с введёнными критериями, данный метод является гибридным с точки зрения уровня наблюдения за системой, верифицируемым, устойчивым, имеет низкую вычислительную сложность (линейную относительно длины трассы наблюдаемых переходов и числа состояний), но не является адаптивным.

\textbf{Графы сценариев атак:} На вход системе верификации подаётся конечная модель защищаемой системы и некоторое формальное свойство корректности, которое выполняется только для разрешённого поведения системы. Данное свойство корректности делит всё множество поведений на два класса~--- допустимого поведения, для которого свойство выполняется, и недопустимого, для которого оно не выполняется. Отличие данного метода от обычных систем верификации заключается в том, что их задача, обычно, найти один контрпример из множества недопустимого поведения, а в предложенном методе строится полный набор таких примеров для конкретной защищаемой системы, что даёт на выходе описание возможных путей атаки. Из-за высокой вычислительной сложности (NP) данный метод может быть использован для поиска уязвимостей проектирования систем и других сложных для обнаружения уязвимостей, но для задачи обнаружения атак в реальном времени он неприменим. По остальным критериям метод является гибридным, верифицируемым, устойчивым и адаптивным.

\textbf{Нейронные сети:} Так как задачу обнаружения атак можно рассматривать как задачу распознавания образов (или задачу классификации), то для её решения также применяются нейронные сети. Для этого функционирование защищаемой системы и взаимодействующих с ней внешних объектов представляется в виде траекторий в некотором числовом пространстве признаков. В качестве метода обнаружения злоупотреблений, нейронные сети обучаются на примерах атак каждого класса и, в дальнейшем, используются для распознавания принадлежности наблюдаемого поведения одному из классов атак. Основная сложность в использовании нейросетей заключается в корректном построении такого пространства признаков, которое позволило бы разделить классы атак между собой и отделить их от нормального поведения. Кроме того, для классических нейронных сетей характерно долгое обучение, при этом время обучения зависит от размера обучающей выборки. В соответствии с введёнными критериями, нейронные сети используются на сетевом и узловом уровнях, являются адаптивными, имеют сравнительно низкую вычислительную сложность. При этом они не являются верифицируемыми и устойчивы, как правило, только в пределах той сети, в которой они обучались, что существенно ограничивает применимость метода (только локальная устойчивость).

\textbf{Иммунные сети:} Также как и нейронные сети, иммунные сети являются механизмом классификации и строятся по аналогии с иммунной системой живого организма. Основное достоинство иммунных сетей заключатся в возможности получения <<антител>> к неизвестным атакам. В одной работе (РАБОТА) была предложена модель формального пептида, для которой заявлена возможность использования в системах обнаружения атак. Однако, позже было показано, что использование данного метода требует решения системы дифференциальных уравнений в режиме обнаружения, что даёт вычислительную сложность порядка $O(n^3)$ при использовании метода Рунге-Кутта. В соответствии с введёнными критериями, данная группа методов применима для сетевого и узлового уровней, не верифицируема, адаптивна, устойчива только локально, имеет высокую вычислительную сложность.

\textbf{Support vector machines (SVM):} SVM – это метод представления и распознания шаблонов, который позволяет формировать шаблоны в результате обучения. Данный метод требует небольшого количества данных для обучения и позволяет обрабатывать векторы признаков большой размерности, что полезно для повышения точности систем обнаружения атак и снижения временных затрат на обучение и переобучение. Метод применим как для обнаружения злоупотреблений, так и для обнаружения аномалий. SVM имеет такие же достоинства и недостатки для решения нашей задачи, как и нейронные сети, т.е. является адаптивным, но неверифицируемым.

\textbf{Экспертные системы:} Использование экспертных систем для обнаружения атак основано на описании функционирования системы в виде множества фактов и правил вывода, в том числе для атак. На вход экспертная система получает данные о наблюдаемых событиях в системе в виде фактов. На основании фактов и правил вывода система делает вывод о наличии или отсутствии атаки. Данная группа методов удовлетворяет практически всем критериям (верифицируема, адаптивна, устойчива), но в общем случае имеет очень большую вычислительную сложность, так как для нее может наблюдаться явление <<комбинаторного взрыва>> и полного перебора большого числа альтернатив.

\textbf{Методы, основанные на спецификациях:} В основе данного метода лежит описание ограничений на запрещенное поведение объектов в защищаемой системе в виде спецификаций атак. В спецификацию может входить: ограничения на загрузку ресурсов, на список запрещенных операций и их последовательностей, на время суток, в течение которого применимы те или иные ограничения. Соответствие поведения спецификации считается атакой. Спецификации используются для сетевого уровня, является верифицируемым, локально устойчивым и имеет низкую вычислительную сложность. Данный подход близок к классу методов обнаружения аномалий. Основные недостатки~--- низкая адаптивность и сложность разработки спецификаций.

\textbf{Multivariate Adaptive Regression Splines (MARS):} Один из методов аппроксимации функций, основанный на сплайнах. Аналогично нейронным сетям и кластерному анализу MARS оперирует в многомерном пространстве признаков. Поведение сетевых объектов отображается в последовательности векторов данного пространства. Задача процедуры MARS заключается в построении оптимальной аппроксимации поведения по заданной истории в виде обучающего множества векторов, при этом в качестве аппроксимирующей функции используются сплайны с переменным числом вершин. В ходе <<обучения>>, с помощью переборного процесса, выбирается оптимальное число вершин для заданной выборки. Построенный сплайн является <<шаблоном>> атаки. В режиме распознавания наблюдаемое поведение отображается в параметрическое пространство и сравнивается с аппроксимирующей функцией. Достоинства и недостатки данного метода аналогичны SVM и нейронным сетям.

\textbf{Сигнатурные методы:} Наиболее часто используемая группа методов, суть которых заключается в составлении некоторого алфавита из наблюдаемых в системе событий и описании множества сигнатур атак в виде регулярных выражений (в общем случае) в построенном алфавите. Как правило, сигнатурные методы работают на самом низком уровне абстракции и анализируют непосредственно передаваемые по сети данные, параметры системных вызовов и записи файлов журналов. В наиболее развитом виде представляет собой реализацию регулярных выражений над различными трассами (сетевой трафик, системные вызовы, записи журналов приложений и т.п.). Сигнатурные методы примечательны тем, что для них хорошо применимы аппаратные ускорители, но при этом метод не является адаптивным. По остальным критериям данная группа методов является гибридной, глобально устойчивой, верифицируемой. 

\subsubsection{Методы обнаружения аномалий}

\textbf{Статистический анализ:} Данная группа методов основана на построении статистического профиля поведения системы в течение некоторого периода <<обучения>>, при котором поведение системы считается нормальным. Для каждого параметра функционирования системы строится интервал допустимых значений, с использованием некоторого известного закона распределения. Далее, в режиме обнаружения, система оценивает отклонения наблюдаемых значений от значений, полученных во время обучения. Если отклонения превышают некоторые заданные значения, то фиксируется факт аномалии (атаки). Для статистического анализа характерен высокий уровень ложных срабатываний при использовании в локальных сетях, где поведение объектов не имеет гладкого, усреднённого характера. Кроме того, данный метод устойчив только в пределах конкретной системы, то есть построенные статистические профили нельзя использовать на других аналогичных системах. 

\textbf{Кластерный анализ:} Суть данной группы методов состоит в разбиении множества наблюдаемых векторов-свойств системы на кластеры, среди которых выделяют кластеры нормального поведения. В каждом конкретном методе кластерного анализа используется своя метрика, которая позволяет оценивать принадлежность наблюдаемого вектора свойств системы одному из кластеров или выход за границы известных кластеров. Кластерный анализ является адаптивным, но не верифицируемым и устойчивым в пределах конкретной системы, в которой собирались данные для построения кластеров.

\textbf{Нейронные сети:} Нейронные сети для обнаружения аномалий обучаются в течение некоторого периода времени, когда всё наблюдаемое поведение считается нормальным. После обучения нейронная сеть запускается в режиме распознавания. В ситуации, когда во входном потоке не удается распознать нормальное поведение, фиксируется факт атаки. В случае использования репрезентативной обучающей выборки нейронные сети дают хорошую устойчивость в пределах заданной системы; но составление подобной выборки является серьёзной и сложной задачей.  Классические нейронные сети имеют высокую вычислительную сложность обучения, что затрудняет их применение на больших потоках данных. 

\textbf{Иммунные сети:} Обнаружение аномалий является одним из возможных приложений иммунных методов. Так как количество примеров нормального поведения обычно на порядки превышает число примеров атак, использование иммунных сетей для обнаружения анормалий имеет большую вычислительную сложность. 

\textbf{Экспертные системы:} Информация о нормальном поведении представляется в подобных системах в виде правил, а наблюдаемое поведение в виде фактов. На основании фактов и правил принимается решение о соответствии наблюдаемого поведения <<нормальному>>, либо о наличии аномалии. Главный недостаток подобных систем~--- высокая вычислительная сложность (в общем случае). В том числе при обнаружении аномалий. 

\textbf{Поведенческая биометрия:} Включает в себя методы, не требующие специального оборудования (сканеров сетчатки, отпечатков пальцев), т.е. методы обнаружения атак, основанные на наблюдения клавиатурного почерка и использования мыши. В основе методов лежит гипотеза о различии «почерка» работы с интерфейсами ввода-вывода для различных пользователей. На базе построенного профиля нормального поведения для данного пользователя обнаруживаются отклонения от этого профиля, вызванные попытками других лиц работать с клавиатурой или другими физическими устройствами ввода. Поведенческая биометрия имеет строго локальную устойчивость (в пределах одной сети) и слабо верифицируема.

\textbf{Support vector machines (SVM):} SVM применим как для обнаружения злоупотреблений, так и для обнаружения аномалий, при этом метод имеет достоинства и недостатки, аналогичные нейронным сетям

\newcommand{\specialcell}[2][c]{%
  \begin{tabular}[#1]{@{}c@{}}#2\end{tabular}}

\subsubsection{Результаты сравнительного анализа}

{\footnotesize
\begin{table}[htb]
\centering
\caption{Результаты сравнения методов обнаружения атак}
\begin{tabular}{ | p{2.5cm} | c | c | c | c | c | c |}
	\hline
  \specialcell{~~~~~~~~~Критерий\\Метод} & \specialcell{Уровень\\наблюдения} & \specialcell{Аномалии / \\Злоупотр.} & Вериф & Адапт & Устойч & Выч. сложность \\ \hline
  Системы переходов & Hybrid & -/+ & + & - & + & $O(n)$ \\ \hline
  Графы атак & Hybrid & -/+ & + & + & + & $NP$ \\ \hline
  Нейронные сети & NIDS, HIDS & +/+ & - & + & - & $O(n)$ и выше \\ \hline
  Имунные сети & NIDS, HIDS & +/+ & - & + & - & $O(n)$ и выше \\ \hline
  SVM & NIDS, HIDS & +/+ & - & + & - & $ln(n)$\\ \hline
  Экспертные системы & NIDS, HIDS & +/+ & + & + & + & $NP$\\ \hline 
  Спецификации & NIDS & -/+ & + & - & - & $ln(n)$\\ \hline
  MARS & NIDS, HIDS & -/+ & - & + & - & $O(n)$ и выше \\ \hline
  Сигнатурные методы & Hybrid & -/+ & + & - & + & $ln(n)$ \\ \hline
  Статистические методы & NIDS, HIDS & +/- & - & + & - & $O(n)$ и выше \\ \hline
  Кластерный анализ & Hybrid & +/+ & - & + & - & $O(n)$ и выше \\ \hline
  Поведенческая биометрия & HIDS & +/- & - & + & - & $O(n)$ и выше \\ \hline
\end{tabular}
\end{table}
}

Таким образом, анализ публикаций показывает, что для большинства методов обнаружения аномалий характерна слабая верифицируемость и слабая глобальная устойчивость (либо её отсутствие). Основное достоинство методов обнаружения аномалий заключается в их адаптивности и способности обнаруживать ранее неизвестные атаки. Среди глобально устойчивых и верифицируемых методов, имеющих при этом низкую вычислительную сложность, можно отметить метод анализа системы переходов и простой сигнатурный метод. Ни один из рассмотренных методов не обладает одновременно адаптивностью, устойчивостью и верифицируемостью, имея при этом приемлемую вычислительную сложность.

\subsection{\textsc{Современные открытые системы обнаружения атак}}

В данном разделе рассмотрены доступные на сегодняшний день системы
обнаружения атак с открытым исходным кодом.

\subsubsection{Исследованные системы обнаружения атак}

Всего рассмотрено 5 систем обнаружения атак. В таблице 2 приведена краткая информация по каждой из них.

\begin{table}[htb]
\centering
\caption{Открытые системы обнаружения компьютерных атак}

\begin{tabular}{ | l | l | l | }

\hline
Название & Производитель & Ссылки \\ \hline
Bro & \specialcell{University of California, Lawrence\\Berkeley National Laboratory} & http://bro-ids.org/ \\ \hline
OSSEC & Daniel B. Sid, OSSEC.net & http://www.ossec.net/ \\ \hline
STAT & \specialcell{University of California\\at Santa Barbara} & http://www.cs.ucsb.edu/seclab/index.html \\ \hline
Prelude & \specialcell{Yoann Vandoorselaere,\\Laurent Oudot} & http://www.prelude-ids.org/ \\ \hline
Snort & Martin Roesch & http://www.snort.org/ \\ \hline

\end{tabular}
\end{table}


Часть рассмотренных систем (Bro, NetSTAT) разработаны в университетах и
базируются на исследованиях в области обнаружения атак, проведенных в этих
университетах.

\subsubsection{Результаты сравнительного анализа}

В данном разделе приводятся результаты сравнения рассмотренных СОА. Системы
сравниваются отдельно по каждому из вышеуказанных критериев.
Сводная таблица сравнения СОА по всем критериям дана в конце раздела.
Все рассмотренные системы используют в качестве основного метода обнаружения
атак сигнатурный метод (сравнение строк, шаблонов).

Система Bro \cite{bib:bro} использует регулярные выражения над трассами, которые
формируются сетевыми протоколами. Набор регулярных выражений создаётся
экспертами. Кроме того, в состав системы входит транслятор сигнатур из формата
системы Snort в сценарии Bro (хотя в настоящее время этот транслятор поддерживает
не все конструкции языка Snort).

Система OSSEC \cite{bib:ossec} является монолитной – в сенсоры и анализаторы «зашиты» знания
разработчиков системы обнаружения атак о том, какие последовательности сообщений
в журналах могут быть признаками атаки. Такая архитектура системы является трудно
расширяемой с точки зрения базы знаний об атаках.

Система NetSTAT \cite{bib:netstat} использует язык описания сценариев атак STATL, особенностью
которого является возможность описания сценария атаки в виде последовательности
действий над атакуемым ресурсом. Таким образом, эта система использует метод
обнаружения, близкий к методу анализа переходов состояний.

Система Prelude \cite{bib:prelude} использует различные анализирующие компоненты для сетевых
данных и журналов регистрации. Для анализа сетевых данных можно использовать
систему Snort. Также используется набор специализированных модулей для
обнаружения специфических атак, таких как сканирование портов, некорректные ARP-
пакеты и т.п. Специальные модули производят дефрагментацию IP, сборку TCP-потока,
декодирование HTTP-запросов.

Система Snort \cite{bib:snort} использует базу сигнатур известных атак. В ней также используется
набор специализированных модулей для обнаружения специфических атак, таких как
сканирование портов или отправка большого числа фрагментированных пакетов.
Специальные модули производят дефрагментацию IP, декодирование HTTP-запросов.
Сторонние разработчики часто реализуют другие методы обнаружения атак в виде
модулей (препроцессоров) Snort. Но в основную версию системы они не входят.\\

\textbf{Класс обнаруживаемых атак}

Все исследованные системы могут обнаруживать атаки нескольких классов.
Поэтому для улучшения читаемости и сокращения объема текста вводятся понятия
объединения, пересечения и вложения классов атак. Для обозначения объединения и
пересечения классов атак будем использовать символы $\cup$ и $\cap$ соответственно.

Системы, рассмотренные в данной работе, предназначены для обнаружения атак
разных классов. Часть систем ориентирована на обнаружения узловых атак, и
использует для анализа такие источники как журналы регистрации приложений, ОС,
журналы систем аудита (OSSEC). Другие системы обнаруживают только внешние
(сетевые) атаки и используют для анализа информацию, получаемую из каналов
передачи данных в сети (Bro, Snort). Остальные системы являются гибридными и
обнаруживают как локальные, так и внешние атаки (STAT, Prelude).

Система Bro является сетевой системой обнаружения атак. Она представляет собой
набор модулей декомпозиции данных различных сетевых протоколов (от сетевого до
прикладного уровня) и набор сигнатур над событиями соответствующих протоколов.
Сигнатуры Bro фактически представляют собой регулярные выражения в алфавитах
протоколов.

Данная система обнаруживет атаки следующих классов (L,R,A,D):

\begin{itemize}

\item L=\{\textbf{li} $\cup$ \textbf{le}\} (внутренние и внешние атаки)
\item R=\{\textbf{rn}\} $\cap$ \{\textbf{ru} $\cup$ \textbf{rs}\} (атаки на сетевые пользовательские ресурсы и системные ресурсы)
\item A=\{\textbf{as} $\cup$ \textbf{au} $\cup$ \textbf{ar} $\cup$ \textbf{ad}\} (сбор информации о системе, попытки получения
прав пользователя, попытки получения прав администратора и нарушение
работоспособности ресурса)
\item D=\{\textbf{dn} $\cup$ \textbf{dd}\} (нераспределенные и распределенные)

\end{itemize}

Система OSSEC, единственная из рассмотренных в данной работе, является
изначально ориентированной на обнаружение атак уровня системы (узловых). Она
наиболее <<молодая>> из рассмотренных систем; её последняя версия предназначена, в
частности, для анализа журналов регистрации UNIX, типовых приложений (ftpd,
apache, mail, etc), а также журналов межсетевых экранов и сетевых СОА. OSSEC
включает в себя набор анализаторов для различных источников данных, контроль
целостности файловой системы, сигнатуры известных троянских закладок (rootkits) и
пр.

Обнаруживаются атаки следующих классов:

\begin{itemize}

\item L=\{\textbf{li}\} (атакующие объекты находятся внутри системы)
\item R=\{\textbf{rl}\} $\cap$ \{\textbf{ru} $\cup$ \textbf{rs}\} (узловые пользовательские и системные ресурсы)
\item A=\{\textbf{au} $\cup$ \textbf{ar} $\cup$ \textbf{ai}\} (попытки получения прав пользователя, попытки
получения прав администратора, нарушение целостности ресурса)
\item D=\{\textbf{dn} $\cup$ \textbf{dd}\} (нераспределенные и распределенные)

\end{itemize}

Система STAT является экспериментальной университетской разработкой, и
наиболее <<старой>> из рассматриваемых систем --- первые публикации по STAT
датируются 1992 годом. Система включает в себя набор компонентов обнаружения
атак различных уровней --- сетевой (NetSTAT), узловой (USTAT, WinSTAT),
приложений (WebSTAT), т.е. является классической гибридной системой.

СОА обнаруживает атаки следующих классов:

\begin{itemize}

\item L=\{\textbf{li} $\cup$ \textbf{le}\} (внутренние и внешние атаки)
\item R=\{\textbf{rl} $\cup$ \textbf{rn}\} $\cap$ \{\textbf{ru} $\cup$ \textbf{rs}\} (атаки на узловые или сетевые пользовательские
ресурсы и системные ресурсы);
\item A=\{\textbf{as} $\cup$ \textbf{au} $\cup$ \textbf{ar} $\cup$ \textbf{ad}\} (сбор информации о системе, попытки получения
прав пользователя, попытки получения прав администратора и нарушение
работоспособности ресурса)
\item D=\{\textbf{dn}\} (нераспределенные)

\end{itemize}

Система Prelude, как и NetSTAT, является гибридной, т.е. способна обнаружить
атаки как на уровне системы, так и на уровне сети. Данная система изначально
разрабатывалась в качестве самостоятельной СОА, но в настоящее время является
высокоуровневой надстройкой над открытыми СОА и системами контроля целостности
(AIDE, Osiris и т.п.). Узловая часть Prelude имеет достаточно широкий набор описаний
атак и, в качестве источника информации, использует различные журналы регистрации:

\begin{itemize}

\item журналы регистрации межсетевого экрана IPFW
\item журналы регистрации NetFilter ОС Linux
\item журналы регистрации маршрутизаторов Cisco and Zyxel
\item журналы регистрации GRSecurity
\item журналы регистрации типовых сервисов OC UNIX и другие

\end{itemize}

СОА обнаруживает атаки следующих классов:

\begin{itemize}

\item L=\{\textbf{li} $\cup$ \textbf{le}\} (внутренние и внешние атаки)
\item R=\{\textbf{rl} $\cup$ \textbf{rn}\} $\cup$ \{\textbf{ru} $\cup$ \textbf{rs} $\cup$ \textbf{rp}\} (атаки на локальные или сетевые
пользовательские ресурсы, системные ресурсы и ресурсы защиты)
\item A=\{\textbf{as} $\cup$ \textbf{au} $\cup$ \textbf{ar} $\cup$ \textbf{ad}\} (сбор информации о системе, попытки получения
прав пользователя, попытки получения прав администратора и нарушение
работоспособности ресурса)
\item D=\{\textbf{dn}\} (нераспределенные)

\end{itemize}

Система Snort это наиболее популярная на сегодняшний день некоммерческая СОА.
Она активно и динамично развивается, обновления базы известных атак происходят с
частотой, сравнимой с коммерческими аналогами (обычно обновления Snort опережают
коммерческие). Snort является чисто сетевой СОА и, кроме основной базы описаний
атак, имеет набор подключаемых модулей для обнаружения специфических атак или
реализующих альтернативные методы обнаружения.

Система способна обнаружить атаки следующих классов:

\begin{itemize}

\item L=``внутренние'' $\cup$ ``внешние''
\item R=\{\textbf{rl} $\cup$ \textbf{rn}\} $\cap$ \{\textbf{ru} $\cup$ \textbf{rs} $\cup$ \textbf{rp}\} (атаки на локальные или сетевые
пользовательские ресурсы, системные ресурсы и ресурсы защиты);
\item A=\{\textbf{as} $\cup$ \textbf{au} $\cup$ \textbf{ar} $\cup$ \textbf{ad}\} (сбор информации о системе, попытки получения
прав пользователя, попытки получения прав администратора и нарушение
работоспособности ресурса);
\item D=\{\textbf{dn} $\cup$ \textbf{dd}\} (нераспределенные и распределенные).

\end{itemize}

Таким образом, ни одна из рассмотренных систем не покрывает всё множество
классов атак. Следует также отметить, что эти системы используют неадаптивные
методы обнаружения атак.\\

\textbf{Уровень наблюдения за системой}

Все рассмотренные выше системы работают с данными приложений и
операционной системы на узловом уровне, а так же с сетевыми данными. То есть
анализируемая информация получается из вторичных источников, таких как журналы
регистрации приложений, ОС, либо из сетевого канала передачи данных.
Система OSSEC работает исключительно с журналами регистрации приложений и
операционной системы. Системы Bro, Snort анализируют только сетевые данные.
Системы NetSTAT и Prelude анализируют как данные из локальных системных
источников, так и сетевые данные.
Из рассмотренных систем ни одна не покрывает все уровни наблюдения, и
анализируемая каждой системой информация неполна с точки зрения возможности
обнаружения атак всех классов. Для обнаружения атак всех классов необходимо
анализировать информацию на всех трёх уровнях одновременно.\\

\textbf{Адаптивность к неизвестным атакам}

На данный момент эта возможность в рассмотренных СОА отсутствует. Возможно
использование экспериментального модуля статистического анализа системы Snort, но
его эффективность не изучена. За счет контроля целостности ресурсов узла в системе
OSSEC присутствует условная адаптивность. Тем не менее, следует признать, что
контроль целостности решает не задачу обнаружения атак, а лишь задачу обнаружения
их последствий. Таким образом, адаптивность к неизвестным атакам в рассмотренных
СОА, в целом, отсутствует.\\

\textbf{Масштабируемость}

Система Bro является нераспределённой и управляется централизованно на том
узле, где она установлена, с помощью файлов конфигурации. При увеличении числа
защищаемых узлов и каналов связи необходимо устанавливать дополнительные
независимые экземпляры системы Bro, что означает фактическую немасштабируемость.

Система OSSEC является распределённой и управляется либо распределенно на
узлах, где установлены агенты (при помощи файлов конфигурации), либо
централизованно с помощью специализированной утилиты администрирования
с центрального сервера OSSEC. Система является хорошо
масштабируемой.

Система NetSTAT также является распределённой и управляется распределенно
через файлы конфигурации на всех узлах, где расположены компоненты системы.
Индивидуальное управление компонентов системы делает процесс управления и
настройки сложным и длительным, причём с ростом числа компонентов сложность
настройки и внесения изменений в конфигурацию усложняется.

Система Prelude является распределённой и управляется централизованно при
помощи управляющей консоли. Компоненты системы сами предоставляют
управляющей консоли те параметры их функционирования, которые могут изменяться.
Управление производится по защищенному каналу (SSL). Также управление может
осуществляться через локальные конфигурационные файлы на тех узлах, где
установлены компоненты СОА. Данная система является хорошо масштабируемой.

Система Snort управляется централизованно через файлы конфигурации,
консольные команды и сигналы UNIX. Сама по себе система не является
масштабируемой, но в случае использования Snort в качестве сенсора системы Prelude этот недостаток устаняется.\\

\textbf{Открытость}

Три из рассматриваемых систем, за исключением Bro и OSSEC, имеют открытый
интерфейс для добавления новых анализирующих модулей, а также используют
стандартный для систем обнаружения атак формат обмена сообщениями (IDMEF).

Система Bro позволяет пользователю и сторонним разработчикам расширять набор
сигнатур.

NetSTAT имеет открытый интерфейс для добавления новых агентов и фильтров.

Prelude имеет открытый интерфейс для добавления новых модулей анализа и
реагирования, а так же ведения журналов регистрации. Обмен сообщениями между
компонентами системы происходит по стандарту IDMEF (Intrusion Detection Message
Exchange Format), оптимизированному для высокоскоростной обработки.

Snort имеет открытый интерфейс для добавления новых модулей анализа; имеется
модуль, реализующий протокол SNMPv2.

По совокупности используемых стандартных интерфейсов, системы Prelude и Snort
лучше остальных позволяют наращивать функциональность по обнаружению атак.\\

\textbf{Формирование ответной реакции на атаку}

Встроенную возможность реагирования на атаку имеют все рассматриваемые
системы. В системе NetSTAT это реализовано лишь в тестовом варианте. Система
Prelude имеет набор агентов ответной реакции, которые могут блокировать атакующего
при помощи межсетевого экрана. Ведутся работы по агентам, способным либо
полностью изолировать атакующего, либо уменьшить пропускную способность его
канала. Система Snort имеет встроенную ограниченную возможность реагирования на
атаку путем отправки TCP-пакетов, разрывающих соединение (с установленным
флагом RST), а также ICMP-пакетов, сообщающих атакующему узлу о недоступности
узла, сети или сервиса. Аналогичная функциональность по реагированию доступна в
системе Bro. Система OSSEC позволяет использовать произвольные команды для
реагирования --- для этого необходимо статически задать соответствие между событием,
командой и параметрами её вызова.\\

\textbf{Защищенность}

Все системы, которые пересылают какие-либо данные, используют для этого
защищенные каналы. 

STAT и Prelude используют библиотеку OpenSSL для
шифрования канала между компонентами. 

Snort реализует протокол SNMPv2, в
котором присутствуют функции шифрования паролей при передаче данных.

СОА Prelude имеет дополнительные механизмы, обеспечивающие безопасность ее
компонентов. В системе используется специализированная библиотека, которая делает
безопасными такие библиотечные функции алгоритмического языка С как printf, strcpy,
которые не проверяют размер передаваемых им данных. Библиотека предотвращает
классические ошибки выхода за границы массивов и переполнения буферов.
Дополнительные модули анализа сетевых данных делают систему устойчивой к
некорректным сетевым пакетам на разных уровнях стека и выходу ее компонентов из
строя. Такие атаки, как отправка пакетов с неправильными контрольными суммами,
обнуленными флагами TCP, ресинхронизация сессий, случайная отправка и
<<обрезание>> сегментов системой игнорируются.

Из рассмотренных систем вопрос безопасности наиболее проработан в системе
Prelude.
